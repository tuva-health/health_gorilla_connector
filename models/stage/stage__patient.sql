
-- SELECT statement for Patient
SELECT 
    resourcetype,
    id,
    meta_versionid,
    meta_lastupdated,
    meta_profile_0,
    meta_profile_1,
    text_status,
    text_div,
    active,
    name_0_use,
    name_0_text,
    name_0_family,
    name_0_given_0,
    name_0_given_1,
    gender,
    birthdate,
    extension,
    identifier_0_use,
    identifier_0_type_coding_0_system,
    identifier_0_type_coding_0_code,
    identifier_0_type_coding_0_display,
    identifier_0_type_text,
    identifier_0_system,
    identifier_0_value,
    identifier_1_type_coding_0_system,
    identifier_1_type_coding_0_code,
    identifier_1_type_coding_0_display,
    identifier_1_type_text,
    identifier_1_system,
    identifier_1_value,
    identifier,
    telecom_0_system,
    telecom_0_value,
    telecom_0_use,
    telecom_1_system,
    telecom_1_value,
    telecom_1_use,
    telecom_2_system,
    telecom_2_value,
    telecom_2_use,
    telecom,
    managingorganization_reference,
    managingorganization_display,
    filename,
    processed_date 
FROM {{source('raw', 'patient') }} x
QUALIFY rank() over(partition by filename order by processed_date desc) = 1
